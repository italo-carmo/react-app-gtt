{"version":3,"file":"static/js/834.69cdc6eb.chunk.js","mappings":"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","sources":["views/graficos/index.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { Chart, CategoryScale, LinearScale, PointElement, LineController, LineElement, Legend } from 'chart.js';\nimport LoadingSpinner from 'src/components/Loading'\nChart.register(CategoryScale, LinearScale, PointElement, LineController, LineElement, Legend);\nimport styles from './styles.css'\nimport {\n  CCard,\n\n} from '@coreui/react'\nimport { Alert } from '@coreui/coreui'\nimport useApi from 'src/services/Api'\n\n\nconst Dashboard = () => {\n\n  const [chart, setChart] = useState(null);\n  const [selectedPoint, setSelectedPoint] = useState(null);\n  const [loading, setLoading] = useState(false)\n\n  const convertDurationToHours = (duration, percentage) => {\n    if(duration != '00:00') {\n      if(duration == 0) {\n        return 0\n      } else {\n        const [hours, minutes] = duration.split(':');\n        const totalHours = parseInt(hours, 10) + parseInt(minutes, 10) / 60;\n        return totalHours * percentage;\n      }\n    } else {\n        return null\n      }\n    }\n      \n  const formatDuration = (value) => {\n    const hours = Math.floor(value);\n    const minutes = Math.floor((value - hours) * 60);\n  \n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;\n  };\n\n    const handlePointClick = (event, chart) => {\n      const activePoints = chart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);\n  \n      if (activePoints.length > 0) {\n        const datasetIndex = activePoints[0].datasetIndex;\n        const dataIndex = activePoints[0].index;\n        const datasetLabel = chart.data.datasets[datasetIndex].label;\n        const dataValue = chart.data.datasets[datasetIndex].data[dataIndex];\n        setSelectedPoint({ datasetLabel, dataValue });\n      }\n    };\n\n  const Api = useApi()\n  const fetchData = async () => {\n    setLoading(true)\n    let res = await Api.getEsforcoAereo()\n\n    let effortAvailableHours = []\n    let effortFlownHours = [] \n    let porcentagens = [0.04, 0.08, 0.16, 0.24, 0.32, 0.4, 0.5, 0.61, 0.72, 0.82, 0.92, 1]\n\n    let esforco_total = ''\n\n    res.data.forEach(item => {\n        if((item.nome).trim() == 'TOTAL') {\n          esforco_total = item.alocado\n          let items = [item.jan, item.fev, item.mar, item.abr, item.mai, item.jun, item.jul, item.ago, item.set, item.out, item.nov, item.dez]\n          var acumulado = 0\n          items.forEach(item=>{\n            if(item != '00:00') {\n              let item_parsed = convertDurationToHours(item,1)\n              effortFlownHours.push(item_parsed + acumulado)\n              acumulado += item_parsed\n            } \n\n          })\n\n          porcentagens.forEach(it=>{\n            let novo_esforco = (convertDurationToHours(esforco_total, it))\n            effortAvailableHours.push(novo_esforco)\n          })\n        }\n    });\n    \n    \n\n    // Preencher os meses restantes com zeros\n    const numMissingMonths = 12 - effortFlownHours.length;\n    var acumulado = effortFlownHours[effortFlownHours.length - 1]\n    var average = acumulado/effortFlownHours.length;\n\n\n    for (let i = 0; i < numMissingMonths; i++) {\n      console.log('MEDIA: '+average)\n      effortFlownHours.push(average + acumulado);\n      acumulado+= average\n    }\n\n    const labels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];\n\n    const ctx = document.getElementById('air-effort-chart').getContext('2d');\n\n    const newChart = new Chart(ctx, {\n      type: 'line',\n      data: {\n        labels: labels,\n        datasets: [\n          {\n            label: 'Esforço Aéreo Disponível',\n            data: effortAvailableHours,\n            backgroundColor: 'rgba(75, 192, 192, 0.2)',\n            borderColor: 'rgba(75, 192, 192, 1)',\n            borderWidth: 2,\n            fill: false,\n          },\n          {\n            label: 'Esforço Aéreo Voado (estimando próximos meses)',\n            data: effortFlownHours,\n            backgroundColor: 'rgba(255, 99, 132, 0.2)',\n            borderColor: 'rgba(255, 99, 132, 1)',\n            borderWidth: 2,\n            fill: false,\n          },\n        ],\n      },\n      options: {\n        responsive: true,\n        indexAxis: 'x',\n        onClick: (event) => handlePointClick(event, newChart),\n        scales: {\n          y: {\n            display: true,\n            title: {\n              display: true,\n              text: 'Horas Voadas',\n            },\n            suggestedMax: 1800,\n            ticks: {\n                stepSize: 100, // Defina o intervalo entre as marcas de escala\n              }, // Defina o máximo desejado para o eixo Y\n          },\n        },\n        plugins: {\n          legend: {\n            display: true,\n            labels: {\n              boxWidth: 12,\n            },\n          },\n        },\n      },\n    });\n    setLoading(false)\n    setChart(newChart);\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n\n  return (\n    <>\n      <CCard className=\"mb-6\" style={{flexDirection: 'column'}}>\n      {loading && <div style={{display: 'flex', alignItems: 'center', justifyContent:'center', marginTop:50}}><LoadingSpinner width=\"150px\" black={true}/></div>}\n      <canvas id=\"air-effort-chart\" width=\"400\" height=\"200\" />\n      </CCard>\n      {selectedPoint && (\n        <div className=\"point-info\" style={{display:'flex', alignItens: 'center', justifyContent: 'center'}}>\n          <span>{selectedPoint.datasetLabel}: </span>\n          <span style={{marginLeft:5}}> {formatDuration(selectedPoint.dataValue)}</span>\n        </div>\n      )}\n\n\n     \n    </>\n  )\n}\n\nexport default Dashboard\n"],"names":["Chart","CategoryScale","LinearScale","PointElement","LineController","LineElement","Legend","_useState","useState","_useState2","_slicedToArray","setChart","_useState3","_useState4","selectedPoint","setSelectedPoint","_useState5","_useState6","loading","setLoading","convertDurationToHours","duration","percentage","_duration$split","split","_duration$split2","hours","minutes","parseInt","handlePointClick","event","chart","activePoints","getElementsAtEventForMode","intersect","length","datasetIndex","dataIndex","index","datasetLabel","data","datasets","label","dataValue","Api","useApi","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","effortAvailableHours","effortFlownHours","porcentagens","esforco_total","numMissingMonths","acumulado","average","i","labels","ctx","newChart","wrap","_context","prev","next","getEsforcoAereo","sent","forEach","item","nome","trim","alocado","items","jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez","item_parsed","push","it","novo_esforco","console","log","document","getElementById","getContext","type","backgroundColor","borderColor","borderWidth","fill","options","responsive","indexAxis","onClick","scales","y","display","title","text","suggestedMax","ticks","stepSize","plugins","legend","boxWidth","stop","apply","arguments","useEffect","_jsxs","_Fragment","children","CCard","className","style","flexDirection","_jsx","alignItems","justifyContent","marginTop","LoadingSpinner","width","black","id","height","alignItens","marginLeft","value","Math","floor","concat","toString","padStart","formatDuration"],"sourceRoot":""}