(self.webpackChunkApp_GTT=self.webpackChunkApp_GTT||[]).push([[356],{9356:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var a=n(69060),r=n(3084),i=n(36856),s=(n(94412),n(30260)),l=n(78620),o=n.n(l),c=(n(28352),n(82496));const d=()=>{const[e,t]=(0,a.useState)([]),[n,l]=(0,a.useState)(""),[d,p]=(0,a.useState)(new Date),[u,g]=(0,a.useState)(""),[m,h]=(0,a.useState)(0),[f,x]=(0,a.useState)(!1),[v,y]=(0,a.useState)("Simples"),[j,T]=(0,a.useState)(new Date),[S,b]=(0,a.useState)([]),[w,C]=(0,a.useState)(!1),[D,I]=(0,a.useState)(""),[A,O]=(0,a.useState)(""),[k,E]=(0,a.useState)(""),[_,R]=(0,a.useState)(!1),[N,P]=(0,a.useState)(!1),[M,L]=(0,a.useState)(!1),[V,B]=(0,a.useState)(0),F=(0,i.c)(),U=e=>{let{value:t,onClick:n}=e;return(0,c.jsx)("img",{style:{cursor:"pointer",marginLeft:5},src:"https://www.1gtt.com.br/app/calendar-black.png",width:"30px",onClick:n})};function z(e){if(isNaN(e)||e<0)return"Invalid input";const t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),a=String(t).padStart(2,"0"),r=String(n).padStart(2,"0");return"".concat(a,":").concat(r)}const H=async e=>{P(!0);let t=await F.getNotam({icao:e});if(t.error)return alert(t.error),void P(!1);t.data=t.data.replace(/CLSD/g,'<span class="red-span">CLSD</span>'),t.data=t.data.replace(/U\/S/g,'<span class="red-span">U/S</span>'),t.data=t.data.replace(/TORA/g,'<span class="red-span">TORA</span>'),t.data=t.data.replace(/TODA/g,'<span class="red-span">TODA</span>'),t.data=t.data.replace(/LDA/g,'<span class="red-span">LDA</span>'),t.data=t.data.replace(/ASDA/g,'<span class="red-span">ASDA</span>'),t.data=t.data.replace('<h4 id="notam_number_display" class="heading-primary mt-4 text-center">NOTAM (Carregando ...)</h4>',""),O(t.data),P(!1),R(!0)},$=e=>{try{"string"!=typeof e&&(e=e.toISOString());let[t,n]=e.split("T"),[a,r,i]=n.split(":");return a+":"+r}catch{return"00:00"}},Z=e=>{try{"string"!=typeof e&&(e=e.toISOString());let[t,n]=e.split("T"),[a,r,i]=t.split("-");return i+"/"+r+"/"+a}catch{return"00:00"}};function W(e){console.log("arredondando: "+e);const t=e/6e4;if(console.log(t),t%5===0)return e;{const e=6e4*(5*Math.ceil(t/5));return console.log("retornando: "+e),e}}const G=async()=>{let e=n.replace(/ /g,"").split(","),t=await F.getPlanejamento({rota:e});if(t.error)return void alert(t.error);const a=[];let r=d;return t.data.forEach(((e,t)=>{const n=new Date(r.getTime()+e.tempo),i=72e5;a.push({data:r.toISOString().split("T")[0],origem:e.origem,destino:e.destino,DEP:r.toISOString(),ARR:n.toISOString(),TEV:z(W(e.tempo)),tempoSolo:z(i)}),r=new Date(n.getTime()+i)})),a},K=async()=>{if(L(!0),!n)return alert("Rota \xe9 obrigat\xf3ria"),void L(!1);let a=n.replace(/ /g,""),r=a.split(",");if(console.log(a),r.length<=1)return alert("Digite ao menos 2 ICAO"),void L(!1);if(!r.every((e=>4===e.length)))return alert("Confira os ICAOS"),void L(!1);if(!d)return alert("Data Inicial \xe9 obrigat\xf3ria"),void L(!1);if(w){let t=await G();t.rota=n.replace(/ /g,""),(i=[...e])[D]=t}else{let t=await G();var i;t.rota=n.replace(/ /g,""),(i=[...e]).push(t)}t(i),L(!1),l(r[r.length-1]),C(!1),I("")};(0,a.useEffect)((()=>{(()=>{let t=[...e],n=0;t.forEach((e=>{e.forEach((e=>{let[t,a]=e.TEV.split(":"),r=60*parseInt(t)+parseInt(a);console.log("somando: "+r),n+=r}))})),B(n)})()}),[e]);const X=e=>{const[t,n]=e.split(":");return 60*parseInt(t)*60*1e3+60*parseInt(n)*1e3};const q=(n,a,r)=>{let i=[...e];i[n][a].TEV=function(e,t){const n=e.split(":");let a=60*parseInt(n[0])+parseInt(n[1]);a=t?a+5:a-5,a=Math.max(0,a);const r=a%60,i=Math.floor(a/60).toString().padStart(2,"0"),s=r.toString().padStart(2,"0");return"".concat(i,":").concat(s)}(i[n][a].TEV,r),t(i)};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(r.u0,{className:"mb-6",style:{flexDirection:"column",overflowX:"auto",minHeight:500,maxHeight:700},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",marginTop:"20px",marginLeft:10,marginRight:10},children:[(0,c.jsxs)("div",{style:{marginRight:"20px",display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,c.jsx)("label",{children:"Data In\xedcio:"}),(0,c.jsx)("div",{className:"input-obs",style:{marginLeft:5},children:d.toLocaleString([],{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",timeZone:"UTC"})+"Z"}),(0,c.jsx)("div",{style:{zIndex:9999},children:(0,c.jsx)(o(),{selected:d,onChange:e=>{if(e){const t=new Date(e);t.setMinutes(e.getMinutes()-e.getTimezoneOffset()),p(t)}},customInput:(0,c.jsx)(U,{}),showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:5,dateFormat:"LLL",timeZone:"UTC",timeZoneData:[{value:"Etc/UTC",label:"Zulu (GMT 0)"}],utcOffset:0,popperClassName:"datePickerPopper",calendarClassName:"datePickerCalendar"})})]}),(0,c.jsxs)("div",{style:{marginRight:"20px"},children:[(0,c.jsx)("label",{style:{marginRight:5},children:"ROTA:"}),(0,c.jsx)("input",{type:"text",value:n,placeholder:"Digite os ICAO separados por v\xedrgula...",onKeyPress:e=>{"Enter"===e.key&&K()},onChange:e=>{l(e.target.value.toUpperCase())},style:{width:500}})]}),(0,c.jsx)("div",{className:"buttons",children:(0,c.jsx)("button",{style:{backgroundColor:"green",color:"white",padding:"2px 20px",borderRadius:"5px",border:"none",cursor:"pointer",fontSize:12,marginBottom:5},onClick:()=>K(),children:w?"Editar":"Adicionar"})})]}),(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",marginLeft:10,marginRight:10},children:(0,c.jsxs)("div",{style:{marginRight:"20px"},children:[(0,c.jsx)("label",{style:{marginRight:5},children:"Tripula\xe7\xe3o:"}),(0,c.jsxs)("select",{style:{padding:"5px",borderRadius:"10px",border:"1px solid #000"},value:v,onChange:e=>{y(e.target.value)},children:[(0,c.jsx)("option",{value:"",children:"Selecione"}),["Simples","Composta","Revezamento"].map((e=>(0,c.jsx)("option",{value:e,children:e})))]})]})}),M&&(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsx)(s.c,{width:"100px",black:!0})}),(0,c.jsx)("div",{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",marginLeft:10,marginRight:10},children:[(0,c.jsx)("span",{style:{fontWeight:"bold",marginRight:5},children:"Total de horas da miss\xe3o:"})," ",(0,c.jsxs)("span",{children:[" ",function(e){const t=Math.floor(e/60),n=e%60,a=t<10?"0".concat(t):t,r=n<10?"0".concat(n):n;return"".concat(a,":").concat(r)}(parseInt(V))]})]})}),e.map(((n,a)=>{var r=new Date(n[0].DEP),i=new Date(n[0].DEP);"Simples"==v&&r.setTime(r.getTime()+432e5),"Composta"==v&&r.setTime(r.getTime()+504e5),"Revezamento"==v&&r.setTime(r.getTime()+612e5);for(var s=i;r>s;){let e=s.getHours();(e>22||e<6)&&r.setMilliseconds(r.getMilliseconds()-18e5),s.setMilliseconds(s.getMilliseconds()+36e5)}return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:10},children:[(0,c.jsxs)("span",{style:{fontWeight:"bold",marginRight:10},children:["DIA ",a+1]}),(0,c.jsx)("img",{onClick:()=>{C(!0),I(a),l(n.rota);let e=new Date(n[0].DEP);p(e)},width:"15",height:"15",src:"https://www.1gtt.com.br/app/pen.png"})]}),(0,c.jsxs)("table",{style:{marginBottom:20,zIndex:2,width:"90%"},children:[(0,c.jsx)("thead",{className:"tabela-cabecalho",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Data"}),(0,c.jsx)("th",{children:"Origem"}),(0,c.jsx)("th",{children:"Destino"}),(0,c.jsx)("th",{children:"DEP"}),(0,c.jsx)("th",{children:"ARR"}),(0,c.jsx)("th",{children:"TEV"}),(0,c.jsx)("th",{children:"Tempo Solo"})]})}),n.map(((i,s)=>{try{if(0==s)var l=i.DEP;else{var o=0,d=0;for(let e=0;e<s;e++)d+=X(n[e].TEV),o+=X(n[e].tempoSolo);var p=new Date(n[0].DEP);p.setTime(p.getTime()+o+d);l=p}}catch(m){l="00:00"}let u=((e,t)=>{let n=new Date(e),[a,r]=t.split(":"),i=36e5*parseInt(a)+6e4*parseInt(r);return n.setTime(n.getTime()+i),n})(l,i.TEV);var g=!1;return u>r&&(g=!0),(0,c.jsxs)("tr",{style:{color:g?"#FF0000":"#000"},children:[(0,c.jsx)("td",{style:{fontWeight:"bold"},children:5==i.TEV.length?Z(l):""}),(0,c.jsxs)("td",{children:[i.origem,(0,c.jsx)("button",{className:"pegar-notam",onClick:()=>{H(i.origem)},children:"Pegar NOTAM"})]}),(0,c.jsxs)("td",{children:[i.destino,(0,c.jsx)("button",{className:"pegar-notam",onClick:()=>{H(i.destino)},children:"Pegar NOTAM"})]}),(0,c.jsx)("td",{children:5==i.TEV.length?$(l):""}),(0,c.jsx)("td",{children:5==i.TEV.length?$(u):""}),(0,c.jsx)("td",{children:(0,c.jsxs)("div",{style:{display:"flex"},children:[i.TEV,(0,c.jsx)("img",{width:"20px",height:"20px",src:"https://www.1gtt.com.br/seta-cima.png",onClick:()=>q(a,s,!0),style:{marginLeft:5,marginRight:5,cursor:"pointer"}}),(0,c.jsx)("img",{width:"20px",height:"20px",src:"https://www.1gtt.com.br/seta-baixo.png",onClick:()=>q(a,s,!1),style:{cursor:"pointer"}})]})}),(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"text",value:i.tempoSolo,onChange:r=>{const i=r.target.value;let l=[...e],o=n.map(((e,t)=>t===s?{...e,tempoSolo:i}:e));l[a]=o,t(l)}})})]},s)}))]}),(0,c.jsxs)("span",{style:{fontWeight:"bold",marginBottom:50},children:["Limite da Fadiga: ",Z(r)+" "+$(r)]})]})})),_&&(0,c.jsxs)("div",{className:"modal-notam",children:[(0,c.jsx)("span",{className:"close-modal",onClick:()=>{R(!1)},children:"\xd7"}),(0,c.jsx)("div",{className:"modal-content",children:(0,c.jsx)("div",{dangerouslySetInnerHTML:{__html:A}})})]}),N&&(0,c.jsx)("div",{className:"modal-notam",children:(0,c.jsxs)("div",{className:"modal-content",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,c.jsx)("h1",{style:{marginBottom:20},children:"Aguarde..."}),(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsx)(s.c,{black:!0,width:"200px"})})]})}),f&&(0,c.jsx)("div",{style:{position:"absolute",left:"50%",top:"80%",transform:"translate(-50%, -50%)",zIndex:99},children:(0,c.jsx)(s.c,{black:!0,width:"50px"})})]})})}},28352:e=>{window,e.exports=function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"./xmlParser.js":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,a,r;return t=e,(a=[{key:"_parseFromString",value:function(e){var t=this,n=(e=this._encodeCDATAValues(e)).replace(/\s{2,}/g," ").replace(/\\t\\n\\r/g,"").replace(/>/g,">\n").replace(/\]\]/g,"]]\n"),a=[];return n.split("\n").map((function(e){if((e=e.trim())&&!(e.indexOf("?xml")>-1))if(0==e.indexOf("<")&&e.indexOf("CDATA")<0){var n=t._parseTag(e);a.push(n),e.match(/\/\s*>$/)&&a.push(t._parseTag("</"+n.name+">"))}else a[a.length-1].value+=" ".concat(t._parseValue(e))})),this._convertTagsArrayToTree(a)[0]}},{key:"_encodeCDATAValues",value:function(e){for(var t=new RegExp(/<!\[CDATA\[([^\]\]]+)\]\]/gi),n=t.exec(e);n;)n.length>1&&(e=e.replace(n[1],encodeURIComponent(n[1]))),n=t.exec(e);return e}},{key:"_getElementsByTagName",value:function(e){var t=[];return"*"!=e&&this.name.toLowerCase()!==e.toLowerCase()||t.push(this),this.children.map((function(n){t=t.concat(n.getElementsByTagName(e))})),t}},{key:"_parseTag",value:function(e,t){var n=e.match(/([^\s]*)=('([^']*?)'|"([^"]*?)")|([\/?\w\-\:]+)/g),a={name:n.shift().replace(/\/\s*$/,""),attributes:{},children:[],value:"",getElementsByTagName:this._getElementsByTagName};return n.map((function(e){var t=e.split("=");if(!(t.length<2)){var n=t[0],r="";r=2===t.length?t[1]:(t=t.slice(1)).join("="),a.attributes[n]="string"==typeof r?r.replace(/^"/g,"").replace(/^'/g,"").replace(/"$/g,"").replace(/'$/g,"").trim():r}})),a}},{key:"_parseValue",value:function(e){return e.indexOf("CDATA")<0?e.trim():e.substring(e.lastIndexOf("[")+1,e.indexOf("]"))}},{key:"_convertTagsArrayToTree",value:function(e){for(var t=[];e.length>0;){var n=e.shift();if(n.value.indexOf("</")>-1||n.name.match(/\/$/))n.name=n.name.replace(/\/$/,"").trim(),n.value=n.value.substring(0,n.value.indexOf("</")).trim(),t.push(n);else{if(0==n.name.indexOf("/"))break;t.push(n),n.children=this._convertTagsArrayToTree(e),n.value=decodeURIComponent(n.value.trim())}}return t}},{key:"_toString",value:function(e){var t=this,n=this._convertTagToText(e);return e.children.length>0&&(e.children.map((function(e){n+=t._toString(e)})),n+="</"+e.name+">"),n}},{key:"_convertTagToText",value:function(e){var t="<"+e.name;for(var n in e.attributes)t+=" "+n+'="'+e.attributes[n]+'"';return e.value.length>0?t+=">"+e.value:t+=">",0===e.children.length&&(t+="</"+e.name+">"),t}},{key:"parseFromString",value:function(e){return this._parseFromString(e)}},{key:"toString",value:function(e){return this._toString(e)}}])&&n(t.prototype,a),r&&n(t,r),e}()},0:function(e,t,n){e.exports=n("./xmlParser.js")}})}}]);
//# sourceMappingURL=356.8f98ebde.chunk.js.map